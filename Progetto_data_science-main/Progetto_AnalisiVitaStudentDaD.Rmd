---
title: "Analisi sulla didattica a distanza degli studenti durante la pandemia"
author: "JiaPing Huang"
date: "15/6/2021"

output:
  html_document:
    code_folding: hide
    css: struttura.css
    fig_width: 8
    highlight: tango
    theme: cosmo
    toc: yes
  pdf_document:
    keep_tex: yes
    number_sections: yes
    toc: yes
always_allow_html: yes
editor_options: 
  chunk_output_type: inline
runtime: shiny
---


```{r,message=FALSE,warning=FALSE}
#importo le librerie
library(dplyr)
library(tidyverse)
library(tidytext)
library(ggplot2)
library(shiny)
library(shinythemes)
library(gridExtra)
library(plotly)
library(directlabels)
library(utils)
library(grid)
library(knitr)
```


## Introduzione 
  <h3>
  Dopo l'imprevisto della crisi di pandemia nel 2019 ha cambiato la nostra vita quotidiana di tutto il mondo in vari ambiti ,uno dei quali che stiamo convivendo attualmente è la didattica a distanza per tutti gli studenti.
  <br>
  In questo progetto analizziamo in vari aspetti interessanti degli studenti da 48 studenti in 10 settimane 
 </h3>
  <br><br>
  <img src= "Dad_introduzione.jpg"/>
<br><br><br>

```{r,message=FALSE,warning=FALSE}
##Importo del dataset Autostima dell'utente

#per darsi una autostima per la personalità
AutoStima_Caratteristica=read.csv("BigFive.csv")
#5 scelta tra fortemente accordo ,un po accordo ,ne accordo ne disaccordo ,un po non daccordo,fortemente disaccordo.

##Importo del dataset per il sentimento del solitudine
Scala_Solitudine = read.csv("LonelinessScale.csv")
#ogni colonna corrisponde a ogni domanda e ciascun utente puo rispondere 

##Importo del dataset per valutazione per l'esperieza DaD

Sensazione_Sul_Dad= read.csv("panas.csv")
#che sensazione abbia di fronte al DaD
```
<br><br>
<h4>
La tabella riportato sotto in esempio sono cosi come è quello estratto direttamente dal dataset senza nessun manipolazione.<br>
In ogni riga ci sono diversi utenti e per ogni colonna ci sono le domande riferite alle caratteristiche dell'utente.<br>
Dove ogni utente si autovaluta in base al proprio valutazione ,in 5 livelli diversi che sono :<br>
-fortemente disaccordo,<br>
-debolmente disaccordo,<br>
-tra disaccordo e accordo,<br>
-debolmente accordo,<br>
-fortemente accordo.<br>

<h4>

<br>
Esempi di colonne per il dataset di autovalutazione dell'utente:
```{r ,echo= FALSE}
df1<-AutoStima_Caratteristica %>%
  head(5)

kable(df1, format = "markdown")
```
<br><br>
<h4>
La tabella riportato sotto in esempio sono cosi come è quello estratto direttamente dal dataset senza nessun manipolazione.<br>
In ogni riga ci sono diversi utenti e per ogni colonna ci sono le domande riferite alle domande per il livello di solitudine.<br>
Dove ogni utente si autovaluta in base al proprio valutazione ,in 5 livelli diversi che sono :<br>
-spesso,<br>
-di solito,<br>
-qualche volta,<br>
-raramente,<br>
-mai.<br>
</h4>

<br>

Esempio di colonne di dataset per le domande di solitudine:

```{r ,echo= FALSE}
df2<-Scala_Solitudine %>%
  head(5)

kable(df2, format = "markdown")
```
<br><br>
<h4>
La tabella riportato sotto in esempio sono cosi come è quello estratto direttamente dal dataset senza nessun manipolazione.<br>
In ogni riga ci sono diversi utenti e per ogni colonna ci sono diversi emozioni ed sentimenti durante l'esperienza della didattica a distanza.<br>
Dove ciasun utente si autovaluta in base al proprio sentimento,in 5 livelli diversi : 1 il più basso fino 5 il più alto .<br>
</h4>

<br>

Esempio di colonne di dataset per le domande di sentimento per la didattica a distanza:
```{r ,echo= FALSE}
df3<-Sensazione_Sul_Dad %>%
  head(5)

kable(df3, format = "markdown")
```

```{r,message=FALSE,warning=FALSE}
cerca_domanda <- function(num){#estrago dalle stringhe originale le stringhe della caratteristica che mi interessa
  testo_manipulation<-colnames(AutoStima_Caratteristica[,3:46] )
  str_replace_all(testo_manipulation,"[.]","")
  gsub("^.*?\\d",num,testo_manipulation[num])
}
x1<-cerca_domanda(1)
x2<-cerca_domanda(2)
x3<-cerca_domanda(3)
#kable("prova della cerca domanda 1")
#kable(x1,format = "markdown")
#kable("prova della cerca domanda 2")
#kable(x2,format = "markdown")
#kable("prova della cerca domanda 3")
#kable(x3,format = "markdown")
```
<br><br>

<h4>
Dalla tabella autostima prendiamo la notazione di alcuni valutazione e mettiamo in confronto la loro somma della valutazione per vedere andamento in generale.<br>
-il confronto :se sei un chiacchierone <br>
-il confronto :se sei uno che tende di andare in fallimenti con altri<br>
-il confronto :se sei energetico<br>
-il confronto :se sei preoccupato tanto<br>
-il confronto :tendi a diventare pigro<br>
</h4>


<br><br><br>

## Autovalutazione delle carateristiche degli utenti:{.tabset .tabset-fade .tabset-pills}

```{r,message=FALSE,warning=FALSE,out.width="100%"}
#estrae dalla tabella la prima domanda e contare quante valutazione sono in totale prima di prova 
AutoStima_Caratteristica_Questione1_pre = AutoStima_Caratteristica %>%                       
  select(1,2,3) %>% #selezionato il numero n-esima di utente,priodo della epidemia e la loro valutazione
  filter(type=="pre")%>%
  group_by_at(3)%>%#seleziona il numero della colonna a posto di nome(sono lunghi)
  summarise(totale=n())

#estrae dalla tabella la prima domanda e contare quante valutazione sono in totale dopo di prova
AutoStima_Caratteristica_Questione1_post = AutoStima_Caratteristica %>% 
  select(1,2,3) %>%                                    
  filter(type=="post")%>%
  group_by_at(3)%>%#seleziona il numero della colonna a posto di nome(sono lunghi)
  summarise(totale=n())

#sostituisce in italiano 
colnames(AutoStima_Caratteristica_Questione1_pre) <- c("Sono_chiacchierone_prima","totale")
colnames(AutoStima_Caratteristica_Questione1_post) <- c("Sono_chiacchierone_dopo","totale")

#domanda 2
AutoStima_Caratteristica_Questione2_pre = AutoStima_Caratteristica %>% 
  select(1,2,4) %>% 
  filter(type=="pre")%>%
  group_by_at(3)%>%
  summarise(totale=n())

AutoStima_Caratteristica_Questione2_post = AutoStima_Caratteristica %>%
  select(1,2,4) %>% 
  filter(type=="post")%>%
  group_by_at(3)%>% #seleziona il numero della colonna a posto di nome(sono lunghi)
  summarise(totale=n())

colnames(AutoStima_Caratteristica_Questione2_pre) <- c("tende_di_andare_in_fallimenti_con_altri_prima","totale")
colnames(AutoStima_Caratteristica_Questione2_post) <- c("tende_di_andare_in_fallimenti_con_altri_dopo","totale")

#domanda 11

AutoStima_Caratteristica_Questione11_pre = AutoStima_Caratteristica %>% 
  select(1,2,13) %>% 
  filter(type=="pre")%>%
  group_by_at(3)%>%
  summarise(totale=n())

AutoStima_Caratteristica_Questione11_post = AutoStima_Caratteristica %>%
  select(1,2,13) %>% 
  filter(type=="post")%>%
  group_by_at(3)%>% #seleziona il numero della colonna a posto di nome(sono lunghi)
  summarise(totale=n())

colnames(AutoStima_Caratteristica_Questione11_pre) <- c("se_sei_energetico_prima","totale")
colnames(AutoStima_Caratteristica_Questione11_post) <- c("se_sei_energetico_dopo","totale")

#domanda 19

AutoStima_Caratteristica_Questione19_pre = AutoStima_Caratteristica %>% 
  select(1,2,19) %>% 
  filter(type=="pre")%>%
  group_by_at(3)%>%
  summarise(totale=n())

AutoStima_Caratteristica_Questione19_post = AutoStima_Caratteristica %>%
  select(1,2,19) %>% 
  filter(type=="post")%>%
  group_by_at(3)%>% #seleziona il numero della colonna a posto di nome(sono lunghi)
  summarise(totale=n())

colnames(AutoStima_Caratteristica_Questione19_pre) <- c("se_sei_preocupato_tanto_prima","totale")
colnames(AutoStima_Caratteristica_Questione19_post) <- c("se_sei_preocupato_tanto_dopo","totale")

#domanda 23

AutoStima_Caratteristica_Questione23_pre = AutoStima_Caratteristica %>% 
  select(1,2,23) %>% 
  filter(type=="pre")%>%
  group_by_at(3)%>%
  summarise(totale=n())

AutoStima_Caratteristica_Questione23_post = AutoStima_Caratteristica %>%
  select(1,2,23) %>% 
  filter(type=="post")%>%
  group_by_at(3)%>% #seleziona il numero della colonna a posto di nome(sono lunghi)
  summarise(totale=n())

colnames(AutoStima_Caratteristica_Questione23_pre) <- c("tende_a_diventare_pigro_prima","totale")
colnames(AutoStima_Caratteristica_Questione23_post) <- c("tende_a_diventare_pigro_dopo","totale")
```

<br>
Preparazione del grafico a barre:
```{r,message=FALSE,warning=FALSE,out.width="100%"}
#preparazione per il grafico a barre

#estrazione 
q1_pre<-AutoStima_Caratteristica_Questione1_pre[,2]
q1_post<-AutoStima_Caratteristica_Questione1_post[,2]
q2_pre<-AutoStima_Caratteristica_Questione2_pre[,2]
q2_post<-AutoStima_Caratteristica_Questione2_post[,2]
q11_pre<-AutoStima_Caratteristica_Questione11_pre[,2]
q11_post<-AutoStima_Caratteristica_Questione11_post[,2]
q19_pre<-AutoStima_Caratteristica_Questione19_pre[,2]
q19_post<-AutoStima_Caratteristica_Questione19_post[,2]
q23_pre<-AutoStima_Caratteristica_Questione23_pre[,2]
q23_post<-AutoStima_Caratteristica_Questione23_post[,2]

#trasforma in frequenza relativa dato che mancano 7 persone votate
q1_pre<-q1_pre[,1]/46
q2_pre<-q2_pre[,1]/46
q19_pre<-q19_pre[,1]/46
q23_pre<-q23_pre[,1]/46
q1_post<-q1_post[,1]/39
q2_post<-q2_post[,1]/39
q19_post<-q19_post[,1]/39
q23_post<-q23_post[,1]/39


domande<-c("Sono_chiacchierone_prima","Sono_chiacchierone_dopo","tende_di_andare_in_fallimenti_con_altri_prima","tende_di_andare_in_fallimenti_con_altri_dopo","se_sei_energetico_prima","se_sei_energetico_dopo","se_sei_preocupato_tanto_prima","se_sei_preocupato_tanto_dopo","tende_a_diventare_pigro_prima", "tende_a_diventare_pigro_dopo")
#unire la prima con dopo 
q11_pre=q11_pre %>%
  mutate(indice=1:4)#dato che in questo campo ne ha una valutazione in meno quindi bisogna fare un join 
q11_post=q11_post %>%
  mutate(indice=1:5)

x<-right_join(q11_pre,q11_post,by=c("indice"))#prendiamo rightjoin perchè deve seguire come altri in 5 colonne quella che trova viene messo in nullo 
view(x)
x<-c(x[,1]/46,x[,3]/39)


nuovaTabella<-data.frame(q1_pre,q1_post,q2_pre,q2_post,x,q19_pre,q19_post,q23_pre,q23_post)#viene messo dentro nella tabella x
nuovaTabella<-t(nuovaTabella)#faccio la trasposta della matrice riga in colonna

colnames(nuovaTabella)<-c("Agree_a_little","Agree_strongly","Disagree_a_little","Disagree_Strongly","Neither_agree_nor_disagree")
View(nuovaTabella)

nuovaTabella<-data.frame(domanda=domande,nuovaTabella,stringsAsFactors = FALSE)
nuovaTabella[,2]<-trunc(nuovaTabella[,2]*100)
nuovaTabella[,3]<-trunc(nuovaTabella[,3]*100)
nuovaTabella[,4]<-trunc(nuovaTabella[,4]*100)
nuovaTabella[,5]<-trunc(nuovaTabella[,5]*100)
nuovaTabella[,6]<-trunc(nuovaTabella[,6]*100)

nuovaTabella<- nuovaTabella [,c(1,3,2,6,4,5)]#cambiato l'ordine in modo decresente

#•La tabella funziona a metà  
  nuovaTabella %>%
    gather(Agree_strongly,Agree_a_little,Neither_agree_nor_disagree,Disagree_a_little,Disagree_Strongly,key ="emoji",value =tot) %>%
    ggplot(aes(x=domanda,y=tot,fill=emoji))+
     geom_bar(stat="identity")+
     geom_text(aes(label=tot),position = position_stack(vjust = 0.5))+
    coord_flip()+
     scale_fill_manual("Valutazione",values = c("Agree_strongly"="#A7A7AD","Agree_a_little"="#D6AF36","Disagree_a_little"="#A77044","Disagree_Strongly"=                        "#ADD8E6","Neither_agree_nor_disagree"="#7FFFD4"))+
   theme(axis.title.y=element_blank(),
            panel.background=element_blank())+
     labs(title="Differenza tra prima e dopo",y="totale")
```

<br><br><br>



## Emozioni durante la fase di DaD:{.tabset .tabset-fade .tabset-pills}


Un esempio per il confronto per l'esperienza di didatica a distanza:

```{r,message=FALSE,warning=FALSE,out.width="100%"}
Sensazione_Sul_Dad_prima=Sensazione_Sul_Dad %>%
                          filter(type=="pre") 

Sensazione_Sul_Dad_dopo=Sensazione_Sul_Dad %>%
                          filter(type=="post")
  
#1
  #contare quante sono le persone che interessano prima di provare la didatticaica a distanza 
  risultato_interesting_1= Sensazione_Sul_Dad_prima %>%
    group_by(Interested)%>%
    summarise(count=n())%>%
   filter(count<100)%>%
    mutate(type="pre")%>%
    arrange(desc(Interested))
  
 risultato_interesting_1 = risultato_interesting_1[,c(3,1,2)]
  
  kable(risultato_interesting_1,format = "markdown")
  
  
  #quante persone invece hanno valutato dopo aver provato la didatticaica a distanza 
  risultato_interesting_2= Sensazione_Sul_Dad_dopo %>%
    group_by(Interested)%>%
    summarise(count=n()) %>%
   filter(count<100)%>%
     mutate(type="post")%>%
    arrange(desc(Interested))
risultato_interesting_2 = risultato_interesting_2[,c(3,1,2)]
  kable(risultato_interesting_2,format = "markdown")
 
  #Strong,Guilty,Scared,Hostile,Enthusiastic,Proud,Irritable,Alert,Inspired,Nervous,Determined,Attentive,Jittery,Active,Afraid
  #Forte, Colpevole, Spaventato, Ostile, Entusiasta, Orgoglioso, Irritabile, Vigile, Ispirato, Nervoso, Determinato, Attento, Nervoso, Attivo, Paura
  #坚强、内疚、害怕、敌对、热情、骄傲、易怒、警惕、有灵感、紧张、坚定、专心、紧张、积极、恐惧
```
NB: nella seconda parte manca alcune valutazione , di cui 7 hanno abbandonato la valutazione .
NB: i valori sono in percentuale per facilitare il confronto.
```{r,message=FALSE,warning=FALSE,out.width="100%,out.height= 100%"}

ui<-fluidPage(theme = shinytheme("cerulean"),
       navbarPage(
         "Valutazione prima e dopo della didatticaica a distanza",
         tabPanel("Positivo",
                  sidebarPanel(
                    selectInput("EmozioneSelezionato","Input:",c("Interested","Active","Enthusiastic")),
                  ),
                  mainPanel(
                    h1("Risultato"),
                    verbatimTextOutput("Emozione Selezionato"),
                      plotOutput("risultatoPosPlot")
                  )
          ),
          tabPanel("Negativo",
                  sidebarPanel(
                    selectInput("EmozioneSelezionato2","Input:",c("Upset","Distressed","Scared")),
                  ),
                  mainPanel(
                    h1("Risultato"),
                    verbatimTextOutput("EmozioneSelezionato2"),
                      plotOutput("risultatoNegPlot")
                  )
          ),
          tabPanel("Differenza",
                  sidebarPanel(
                    radioButtons("inputRadioButton","Scelta :",c("Active","Interested","Enthusiastic")),
                  mainPanel(h1("Risultato"),tableOutput("tabellaDiConfronto"))
                  )
          )
       )
)#fluidPage

server <- function(input, output,session) {
  Sensazione_Sul_Dad= read.csv("panas.csv")
  Sensazione_Sul_Dad_prima=Sensazione_Sul_Dad %>%
                            filter(type=="pre") 
  Sensazione_Sul_Dad_dopo=Sensazione_Sul_Dad %>%
                            filter(type=="post")
    
  cdata <- session$clientData
  
 
  emozionePositive <- eventReactive(input$EmozioneSelezionato,{
    if(input$EmozioneSelezionato == "Interested"){
          #contare quante sono le persone che interessano prima di provare la didatticaica a distanza 
          risultato_interesting_1= Sensazione_Sul_Dad_prima %>%
            group_by(Interested)%>%
            summarise(count=n())
          
          #calcola la frequenza relativa 
          frequenza_relativa<-trunc((risultato_interesting_1[,2]/46)*100)
          
          #sostituisce il nome della colonna in nome frequenza_relativa
          colnames(frequenza_relativa)<-"frequenza_relativa"
         
          #crea la tabella totale
          risultato_interesting_1<-data.frame(risultato_interesting_1,frequenza_relativa)
  
          #aggiunge i campi per precedente e il successivo
          risultato_interesting_1 = risultato_interesting_1 %>%
            mutate(type="pre")%>%
            arrange(desc(Interested))
         
       
          view(risultato_interesting_1)
         
          
          #quante persone invece hanno valutato dopo aver provato la didatticaica a distanza 
          risultato_interesting_2= Sensazione_Sul_Dad_dopo %>%
            group_by(Interested)%>%
            summarise(count=n())
          
          #calcola la frequenza relativa 
          frequenza_relativa<-trunc((risultato_interesting_2[,2]/39)*100)
          
          #sostituisce il nome della colonna in nome frequenza_relativa
          colnames(frequenza_relativa)<-"frequenza_relativa"
         
          #crea la tabella totale
          risultato_interesting_2<-data.frame(risultato_interesting_2,frequenza_relativa)
  
          #aggiunge i campi per precedente e il successivo
          risultato_interesting_2 = risultato_interesting_2 %>%
            mutate(type="post")%>%
            arrange(desc(Interested))
         
          #unisce le 2 tabelle
         preparazione_table= bind_rows(risultato_interesting_1,risultato_interesting_2)
       
        #crea la tabella ,NB in base alla freq relativa
        graffico_positivo_1=ggplot(data=preparazione_table, aes(x=Interested,y=frequenza_relativa,fill=type))+
          geom_bar(stat="identity", position=position_dodge())+
          geom_text(aes(label=count), vjust=1.6, color="white",position = position_dodge(0.9), size=3.5)+
           scale_fill_brewer(palette="Paired")+
          labs(title="Interesting pre and post")+
          theme_minimal()
        
        graffico_positivo_1
        
    }else if(input$EmozioneSelezionato=="Active"){
       #contare quante sono le persone che attivo prima di provare la didatticaica a distanza 
          risultato_active_1= Sensazione_Sul_Dad_prima %>%
            group_by(Active)%>%
            summarise(count=n())
          
          #calcola la frequenza relativa 
          frequenza_relativa<-trunc((risultato_active_1[,2]/46)*100)
          
          #sostituisce il nome della colonna in nome frequenza_relativa
          colnames(frequenza_relativa)<-"frequenza_relativa"
         
          #crea la tabella totale
          risultato_active_1<-data.frame(risultato_active_1,frequenza_relativa)
  
          #aggiunge i campi per precedente e il successivo
          risultato_active_1 = risultato_active_1 %>%
            mutate(type="pre")%>%
            arrange(desc(Active))
         
       
          view(risultato_active_1)
         
            #quante persone invece hanno valutato dopo aver provato la didatticaica a distanza 
          risultato_active_2= Sensazione_Sul_Dad_dopo %>%
            group_by(Active)%>%
            summarise(count=n())
          
          #calcola la frequenza relativa 
          frequenza_relativa<-trunc((risultato_active_2[,2]/39)*100)
          
          #sostituisce il nome della colonna in nome frequenza_relativa
          colnames(frequenza_relativa)<-"frequenza_relativa"
         
          #crea la tabella totale
          risultato_active_2<-data.frame(risultato_active_2,frequenza_relativa)
  
          #aggiunge i campi per precedente e il successivo
          risultato_active_2 = risultato_active_2 %>%
            mutate(type="post")%>%
            arrange(desc(Active))
         
          #unisce le 2 tabelle
         preparazione_table= bind_rows(risultato_active_1,risultato_active_2)
       
        #crea la tabella ,NB in base alla freq relativa
        graffico_positivo_2=ggplot(data=preparazione_table, aes(x=Active,y=frequenza_relativa,fill=type))+
          geom_bar(stat="identity", position=position_dodge())+
          geom_text(aes(label=count), vjust=1.6, color="white",position = position_dodge(0.9), size=3.5)+
           scale_fill_brewer(palette="Paired")+
          labs(title="Active pre and post")+
          theme_minimal()
        
        graffico_positivo_2
    }else {
     #contare quante ono le persone che attivo prima di provare la didatticaica a distanza 
          risultato_enthusiastic_1= Sensazione_Sul_Dad_prima %>%
            group_by(Enthusiastic)%>%
            summarise(count=n())
          
          #calcola la frequenza relativa 
          frequenza_relativa<-trunc((risultato_enthusiastic_1[,2]/46)*100)
          
          #sostituisce il nome della colonna in nome frequenza_relativa
          colnames(frequenza_relativa)<-"frequenza_relativa"
         
          #crea la tabella totale
          risultato_enthusiastic_1<-data.frame(risultato_enthusiastic_1,frequenza_relativa)
  
          #aggiunge i campi per precedente e il successivo
          risultato_enthusiastic_1 = risultato_enthusiastic_1 %>%
            mutate(type="pre")%>%
            arrange(desc(Enthusiastic))
         
       
          view(risultato_enthusiastic_1)
         
          
          #quante persone invece hanno valutato dopo aver provato la didattica a distanza 
          risultato_enthusiastic_2= Sensazione_Sul_Dad_dopo %>%
            group_by(Enthusiastic)%>%
            summarise(count=n())
          
          #calcola la frequenza relativa 
          frequenza_relativa<-trunc((risultato_enthusiastic_2[,2]/39)*100)
          
          #sostituisce il nome della colonna in nome frequenza_relativa
          colnames(frequenza_relativa)<-"frequenza_relativa"
         
          #crea la tabella totale
          risultato_enthusiastic_2<-data.frame(risultato_enthusiastic_2,frequenza_relativa)
  
          #aggiunge i campi per precedente e il successivo
          risultato_enthusiastic_2 = risultato_enthusiastic_2 %>%
            mutate(type="post")%>%
            arrange(desc(Enthusiastic))
         
          #unisce le 2 tabelle
         preparazione_table= bind_rows(risultato_enthusiastic_1,risultato_enthusiastic_2)
       
        #crea la tabella ,NB in base alla freq relativa
        graffico_positivo_3=ggplot(data=preparazione_table, aes(x=Enthusiastic,y=frequenza_relativa,fill=type))+
          geom_bar(stat="identity", position=position_dodge())+
          geom_text(aes(label=count), vjust=1.6, color="white",position = position_dodge(0.9), size=3.5)+
           scale_fill_brewer(palette="Paired")+
          labs(title="Ethusiastic pre and post")+
          theme_minimal()
        
        graffico_positivo_3
    }
  })
  
  emozioneNegative <- eventReactive(input$EmozioneSelezionato2,{
    if(input$EmozioneSelezionato2 == "Scared"){
        #contare quante sono le persone che interessano prima di provare la didattica a distanza 
          risultato_scared_1= Sensazione_Sul_Dad_prima %>%
            group_by(Scared)%>%
            summarise(count=n())
          
          #calcola la frequenza relativa 
          frequenza_relativa<-trunc((risultato_scared_1[,2]/46)*100)
          
          #sostituisce il nome della colonna in nome frequenza_relativa
          colnames(frequenza_relativa)<-"frequenza_relativa"
         
          #crea la tabella totale
          risultato_scared_1<-data.frame(risultato_scared_1,frequenza_relativa)
  
          #aggiunge i campi per precedente e il successivo
          risultato_scared_1 = risultato_scared_1 %>%
            mutate(type="pre")%>%
            arrange(desc(Scared))
         
       
          view(risultato_scared_1)
         
          
          #quante persone invece hanno valutato dopo aver provato la didattica a distanza 
          risultato_scared_2= Sensazione_Sul_Dad_dopo %>%
            group_by(Scared)%>%
            summarise(count=n())
          
          #calcola la frequenza relativa 
          frequenza_relativa<-trunc((risultato_scared_2[,2]/39)*100)
          
          #sostituisce il nome della colonna in nome frequenza_relativa
          colnames(frequenza_relativa)<-"frequenza_relativa"
         
          #crea la tabella totale
          risultato_scared_2<-data.frame(risultato_scared_2,frequenza_relativa)
  
          #aggiunge i campi per precedente e il successivo
          risultato_scared_2 = risultato_scared_2 %>%
            mutate(type="post")%>%
            arrange(desc(Scared))
         
          #unisce le 2 tabelle
         preparazione_table= bind_rows(risultato_scared_1,risultato_scared_2)
       
        #crea la tabella ,NB in base alla freq relativa
        graffico_negativo_1=ggplot(data=preparazione_table, aes(x=Scared,y=frequenza_relativa,fill=type))+
          geom_bar(stat="identity", position=position_dodge())+
          geom_text(aes(label=count), vjust=1.6, color="white",position = position_dodge(0.9), size=3.5)+
           scale_fill_brewer(palette="Paired")+
          labs(title="Scared pre and post")+
          theme_minimal()
        
        graffico_negativo_1
              
    }else if(input$EmozioneSelezionato2=="Upset"){
      #contare quante sono le persone che interessano prima di provare la didattica a distanza 
          risultato_upset_1= Sensazione_Sul_Dad_prima %>%
            group_by(Upset)%>%
            summarise(count=n())
          
          #calcola la frequenza relativa 
          frequenza_relativa<-trunc((risultato_upset_1[,2]/46)*100)
          
          #sostituisce il nome della colonna in nome frequenza_relativa
          colnames(frequenza_relativa)<-"frequenza_relativa"
         
          #crea la tabella totale
          risultato_upset_1<-data.frame(risultato_upset_1,frequenza_relativa)
  
          #aggiunge i campi per precedente e il successivo
          risultato_upset_1 = risultato_upset_1 %>%
            mutate(type="pre")%>%
            arrange(desc(Upset))
         
       
          view(risultato_upset_1)
         
          
          #quante persone invece hanno valutato dopo aver provato la didattica a distanza 
          risultato_upset_2= Sensazione_Sul_Dad_dopo %>%
            group_by(Upset)%>%
            summarise(count=n())
          
          #calcola la frequenza relativa 
          frequenza_relativa<-trunc((risultato_upset_2[,2]/39)*100)
          
          #sostituisce il nome della colonna in nome frequenza_relativa
          colnames(frequenza_relativa)<-"frequenza_relativa"
         
          #crea la tabella totale
          risultato_upset_2<-data.frame(risultato_upset_2,frequenza_relativa)
  
          #aggiunge i campi per precedente e il successivo
          risultato_upset_2 = risultato_upset_2 %>%
            mutate(type="post")%>%
            arrange(desc(Upset))
         
          #unisce le 2 tabelle
         preparazione_table= bind_rows(risultato_upset_1,risultato_upset_2)
       
        #crea la tabella ,NB in base alla freq relativa
        graffico_negativo_2=ggplot(data=preparazione_table, aes(x=Upset,y=frequenza_relativa,fill=type))+
          geom_bar(stat="identity", position=position_dodge())+
          geom_text(aes(label=count), vjust=1.6, color="white",position = position_dodge(0.9), size=3.5)+
           scale_fill_brewer(palette="Paired")+
          labs(title="Upset pre and post")+
          theme_minimal()
        
        graffico_negativo_2
          
    }else{
       #contare quante sono le persone che interessano prima di provare la didattica a distanza 
          risultato_distressed_1= Sensazione_Sul_Dad_prima %>%
            group_by(Distressed)%>%
            summarise(count=n())
          
          #calcola la frequenza relativa 
          frequenza_relativa<-trunc((risultato_distressed_1[,2]/46)*100)
          
          #sostituisce il nome della colonna in nome frequenza_relativa
          colnames(frequenza_relativa)<-"frequenza_relativa"
         
          #crea la tabella totale
          risultato_distressed_1<-data.frame(risultato_distressed_1,frequenza_relativa)
  
          #aggiunge i campi per precedente e il successivo
          risultato_distressed_1 = risultato_distressed_1 %>%
            mutate(type="pre")%>%
            arrange(desc(Distressed))
         
       
          view(risultato_distressed_1)
         
          
          #quante persone invece hanno valutato dopo aver provato la didattica a distanza 
          risultato_distressed_2= Sensazione_Sul_Dad_dopo %>%
            group_by(Distressed)%>%
            summarise(count=n())
          
          #calcola la frequenza relativa 
          frequenza_relativa<-trunc((risultato_distressed_2[,2]/39)*100)
          
          #sostituisce il nome della colonna in nome frequenza_relativa
          colnames(frequenza_relativa)<-"frequenza_relativa"
         
          #crea la tabella totale
          risultato_distressed_2<-data.frame(risultato_distressed_2,frequenza_relativa)
  
          #aggiunge i campi per precedente e il successivo
          risultato_distressed_2 = risultato_distressed_2 %>%
            mutate(type="post")%>%
            arrange(desc(Distressed))
         
          #unisce le 2 tabelle
         preparazione_table= bind_rows(risultato_distressed_1,risultato_distressed_2)
       
        #crea la tabella ,NB in base alla freq relativa
        graffico_negativo_3=ggplot(data=preparazione_table, aes(x=Distressed,y=frequenza_relativa,fill=type))+
          geom_bar(stat="identity", position=position_dodge())+
          geom_text(aes(label=count), vjust=1.6, color="white",position = position_dodge(0.9), size=3.5)+
           scale_fill_brewer(palette="Paired")+
          labs(title="Distressed pre and post")+
          theme_minimal()
        
        graffico_negativo_3
    }
  })
  
      differenza <- function(valutazione_prima_di_provare,valutazione_dopo_di_provare){
          if(valutazione_prima_di_provare==valutazione_dopo_di_provare){
            return(0)
          }else{
            if(valutazione_prima_di_provare>valutazione_dopo_di_provare){
              risultato1 = valutazione_prima_di_provare - valutazione_dopo_di_provare
              return(risultato1)
            }else{
              risultato2 = valutazione_dopo_di_provare-valutazione_prima_di_provare
               return(risultato2)
            }
          }
        }
    tendenza <- function(valutazione_prima_di_provare,valutazione_dopo_di_provare){
        if(valutazione_prima_di_provare==valutazione_dopo_di_provare){
          return("non cambia")
        }
          if(valutazione_prima_di_provare>valutazione_dopo_di_provare){
            return("diminuiti")
          }else{
             return("aumentati")
          }
        }
      
  tabella <- eventReactive(input$inputRadioButton,{
    if(input$inputRadioButton == ""){
      return ();
    }else{
      if(input$inputRadioButton == "Interested"){
       #contare quante sono le persone che interessano prima di provare la didattica a distanza
          risultato_interesting_1= Sensazione_Sul_Dad_prima %>%
            group_by(Interested)%>%
            summarise(count=n()) %>%
           filter(count<100)%>%
            mutate(type="pre")%>%
            arrange(desc(Interested))

          #quante persone invece hanno valutato dopo aver provato la didattica a distanza
          risultato_interesting_2= Sensazione_Sul_Dad_dopo %>%
            group_by(Interested)%>%
            summarise(count=n()) %>%
           filter(count<100)%>%
             mutate(type="post")%>%
            arrange(desc(Interested))
          
        riassunto1=full_join(risultato_interesting_1,risultato_interesting_2,by=c("Interested"="Interested")) %>%
             mutate( tendenza = tendenza(count.x,count.y),differenza=differenza(count.x,count.y))%>%
             rename( Interessa_prima_di=count.x,
                     Interessa_dopo_di=count.y)
        
       return ( riassunto1)

        }else{
          if(input$inputRadioButton == "Active"){
          #contare quante sono le persone che interessano prima di provare la didattica a distanza
            risultato_active_1= Sensazione_Sul_Dad_prima %>%
              group_by(Active)%>%
              summarise(count=n()) %>%
             filter(count<100)%>%
              mutate(type="pre")%>%
              arrange(desc(Active))

            #quante persone invece hanno valutato dopo aver provato la didattica a distanza
            risultato_active_2= Sensazione_Sul_Dad_dopo %>%
              group_by(Active)%>%
              summarise(count=n()) %>%
             filter(count<100)%>%
               mutate(type="post")%>%
              arrange(desc(Active))

              riassunto2=full_join(risultato_active_1,risultato_active_2,by=c("Active"="Active")) %>%
                   mutate( tendenza = tendenza(count.x,count.y),differenza=differenza(count.x,count.y))%>%
                   rename( Attivo_prima_di=count.x,
                           Attivo_dopo_di=count.y)
              return (riassunto2)
          }else{
              if(input$inputRadioButton=="Enthusiastic"){
                #contare quante sono le persone che interessano prima di provare la didattica a distanza
                risultato_enthusiastic_1= Sensazione_Sul_Dad_prima %>%
                  group_by(Enthusiastic)%>%
                  summarise(count=n()) %>%
                 filter(count<100)%>%
                  mutate(type="pre")%>%
                  arrange(desc(Enthusiastic))
  
                #quante persone invece hanno valutato dopo aver provato la didattica a distanza
                risultato_enthusiastic_2= Sensazione_Sul_Dad_dopo %>%
                  group_by(Enthusiastic)%>%
                  summarise(count=n()) %>%
                 filter(count<100)%>%
                   mutate(type="post")%>%
                  arrange(desc(Enthusiastic))

riassunto3=full_join(risultato_enthusiastic_1,risultato_enthusiastic_2,by=c("Enthusiastic"="Enthusiastic")) %>%
                   mutate( tendenza = tendenza(count.x,count.y),differenza=differenza(count.x,count.y))%>%
                   rename( entusiastico_prima_di=count.x,
                           entusiastico_dopo_di=count.y)
                return (riassunto3)
              }
          }
        }
    }

  })
   output$textout<- renderText({
    paste(input$EmozioneSelezionato)
  })

  output$risultatoPosPlot<- renderPlot({
      emozionePositive()
    })
  output$risultatoNegPlot<- renderPlot({
      emozioneNegative()
    })
   output$tabellaDiConfronto<-renderTable({
     tabella()
    })
  
}#server

shinyApp(ui = ui, server = server)

```

<br><br><br>

## Scala di solitudine:{.tabset .tabset-fade .tabset-pills}

I 2 grafici sotto riportato sono le differenze per le 20 domande di solitudine nel periodo pre-covid e post covid.
```{r ,echo= FALSE}
#manipolazione della tabella di solitudine

 #persone prima dell'esperienza come valutano per eventuali requesiti
  Scala_Solitudine_pre <- Scala_Solitudine %>%
    filter(type=="pre")
  
  #persone dopo dell'esperienza come valutano per eventuali requesiti  
  Scala_Solitudine_post <- Scala_Solitudine %>%
      filter(type=="post")
    
  #raccoltà per ogni domande 
  s1<-Scala_Solitudine_pre %>%
    group_by(X1..I.feel.in.tune.with.the.people.around.me)%>%
    summarise(count=n()) %>%
    arrange(desc(count))
 

  s2<-Scala_Solitudine_pre %>%
    group_by(X2..I.lack.companionship)%>%
    summarise(count=n()) %>%
    arrange(desc(count))
  
  s3<-Scala_Solitudine_pre %>%
    group_by(X3..There.is.no.one.I.can.turn.to)%>%
    summarise(count=n()) %>%
    arrange(desc(count))
  
  s4<-Scala_Solitudine_pre %>%
    group_by(X4..I.do.not.feel.alone)%>%
    summarise(count=n()) %>%
    arrange(desc(count))
  
  s5<-Scala_Solitudine_pre %>%
    group_by(X5..I.feel.part.of.a.group.of.friends)%>%
    summarise(count=n()) %>%
    arrange(desc(count))
  
  s6<-Scala_Solitudine_pre %>%
    group_by(X6..I.have.a.lot.in.common.with.the.people.around.me)%>%
    summarise(count=n()) %>%
    arrange(desc(count))
  
  s7<-Scala_Solitudine_pre %>%
    group_by(X7..I.am.no.longer.close.to.anyone)%>%
    summarise(count=n()) %>%
    arrange(desc(count))
  
  s8<-Scala_Solitudine_pre %>%
    group_by(X8..My.interests.and.ideas.are.not.shared.by.those.around.me)%>%
    summarise(count=n()) %>%
    arrange(desc(count))
  
  s9<-Scala_Solitudine_pre %>%
    group_by(X9..I.am.an.outgoing.person)%>%
    summarise(count=n()) %>%
    arrange(desc(count))
  
  s10<-Scala_Solitudine_pre %>%
    group_by(X10..There.are.people.I.feel.close.to)%>%
    summarise(count=n()) %>%
    arrange(desc(count))
  
  s11<-Scala_Solitudine_pre %>%
    group_by(X11..I.feel.left.out)%>%
    summarise(count=n()) %>%
    arrange(desc(count))
  
  s12<-Scala_Solitudine_pre %>%
    group_by(X12..My.social.relationships.are.superficial)%>%
    summarise(count=n()) %>%
    arrange(desc(count))
  
  s13<-Scala_Solitudine_pre %>%
    group_by(X13..No.one.really.knows.me.well)%>%
    summarise(count=n()) %>%
    arrange(desc(count))
  
  s14<-Scala_Solitudine_pre %>%
    group_by(X14..I.feel.isolated.from.others)%>%
    summarise(count=n()) %>%
    arrange(desc(count))
  
  s15<-Scala_Solitudine_pre %>%
    group_by(X15..I.can.find.companionship.when.I.want.it)%>%
    summarise(count=n()) %>%
    arrange(desc(count))
  
  s16<-Scala_Solitudine_pre %>%
    group_by(X16..There.are.people.who.really.understand.me)%>%
    summarise(count=n()) %>%
    arrange(desc(count))
  
  s17<-Scala_Solitudine_pre %>%
    group_by(X17..I.am.unhappy.being.so.withdrawn)%>%
    summarise(count=n()) %>%
    arrange(desc(count))
  
  s18<-Scala_Solitudine_pre %>%
    group_by(X18..People.are.around.me.but.not.with.me)%>%
    summarise(count=n()) %>%
    arrange(desc(count))
  
  s19<-Scala_Solitudine_pre %>%
    group_by(X19..There.are.people.I.can.talk.to)%>%
    summarise(count=n()) %>%
    arrange(desc(count))
  
  s20<-Scala_Solitudine_pre %>%
    group_by(X20..There.are.people.I.can.turn.to)%>%
    summarise(count=n()) %>%
    arrange(desc(count))
  
  #raccoltà per ogni domande post covid
  p1<-Scala_Solitudine_post %>%
    group_by(X1..I.feel.in.tune.with.the.people.around.me)%>%
    summarise(count=n()) %>%
    arrange(desc(count))
  
  p2<-Scala_Solitudine_post %>%
    group_by(X2..I.lack.companionship)%>%
    summarise(count=n()) %>%
    arrange(desc(count))
  
  p3<-Scala_Solitudine_post %>%
    group_by(X3..There.is.no.one.I.can.turn.to)%>%
    summarise(count=n()) %>%
    arrange(desc(count))
  
  p4<-Scala_Solitudine_post %>%
    group_by(X4..I.do.not.feel.alone)%>%
    summarise(count=n()) %>%
    arrange(desc(count))
  
  p5<-Scala_Solitudine_post %>%
    group_by(X5..I.feel.part.of.a.group.of.friends)%>%
    summarise(count=n()) %>%
    arrange(desc(count))
  
  p6<-Scala_Solitudine_post %>%
    group_by(X6..I.have.a.lot.in.common.with.the.people.around.me)%>%
    summarise(count=n()) %>%
    arrange(desc(count))
  
  p7<-Scala_Solitudine_post %>%
    group_by(X7..I.am.no.longer.close.to.anyone)%>%
    summarise(count=n()) %>%
    arrange(desc(count))
  
  p8<-Scala_Solitudine_post %>%
    group_by(X8..My.interests.and.ideas.are.not.shared.by.those.around.me)%>%
    summarise(count=n()) %>%
    arrange(desc(count))
  
  p9<-Scala_Solitudine_post %>%
    group_by(X9..I.am.an.outgoing.person)%>%
    summarise(count=n()) %>%
    arrange(desc(count))
  
  p10<-Scala_Solitudine_post %>%
    group_by(X10..There.are.people.I.feel.close.to)%>%
    summarise(count=n()) %>%
    arrange(desc(count))
  
  p11<-Scala_Solitudine_post %>%
    group_by(X11..I.feel.left.out)%>%
    summarise(count=n()) %>%
    arrange(desc(count))
  
  p12<-Scala_Solitudine_post %>%
    group_by(X12..My.social.relationships.are.superficial)%>%
    summarise(count=n()) %>%
    arrange(desc(count))
  
  p13<-Scala_Solitudine_post %>%
    group_by(X13..No.one.really.knows.me.well)%>%
    summarise(count=n()) %>%
    arrange(desc(count))
  
  p14<-Scala_Solitudine_post %>%
    group_by(X14..I.feel.isolated.from.others)%>%
    summarise(count=n()) %>%
    arrange(desc(count))
  
  p15<-Scala_Solitudine_post %>%
    group_by(X15..I.can.find.companionship.when.I.want.it)%>%
    summarise(count=n()) %>%
    arrange(desc(count))
  
  p16<-Scala_Solitudine_post %>%
    group_by(X16..There.are.people.who.really.understand.me)%>%
    summarise(count=n()) %>%
    arrange(desc(count))
  
  p17<-Scala_Solitudine_post %>%
    group_by(X17..I.am.unhappy.being.so.withdrawn)%>%
    summarise(count=n()) %>%
    arrange(desc(count))
  
  p18<-Scala_Solitudine_post %>%
    group_by(X18..People.are.around.me.but.not.with.me)%>%
    summarise(count=n()) %>%
    arrange(desc(count))
  
  p19<-Scala_Solitudine_post %>%
    group_by(X19..There.are.people.I.can.talk.to)%>%
    summarise(count=n()) %>%
    arrange(desc(count))
  
  p20<-Scala_Solitudine_post %>%
    group_by(X20..There.are.people.I.can.turn.to)%>%
    summarise(count=n()) %>%
    arrange(desc(count))

colnames(p1)<-c("X1.Mi sento in sintonia con le persone intorno a me","count")
colnames(p2)<-c("X2.Ho la mancanza della relazione della compagnia","count")
 colnames(p3)<-c("X3.Non c’è nessuno che lo posso rivolgermi a ","count")
 colnames(p4)<-c("X4.Non mi sento da solo ","count")
 colnames(p5)<-c("X5.Mi sento parte di un gruppo di amici","count")
 colnames(p6)<-c("X6.Ho molto in comune con le persone intorno a me.","count")
 colnames(p7)<-c("X7.Non sono più vicino a nessuno","count")
 colnames(p8)<-c("X8.I miei interessi non sono condivisi da chi intorno a me ","count")
 colnames(p9)<-c("X9.Sono un estroverso a cui mi sento vicino  ","count")
 colnames(p10)<-c("X10.Ci sono persone che sento vicino a","count")
 colnames(p11)<-c("X11.Mi sento lasciato fuori/ Mi sento escluso","count")
 colnames(p12)<-c("X12.Le mie relazioni sociali sono superficiali","count")
 colnames(p13)<-c("X13.Nessuno mi conosce davvero bene","count")
 colnames(p14)<-c("X14.Mi sento isolato dagli altri","count")
 colnames(p15)<-c("X15.Posso trovare compagnia quando lo voglio ","count")
 colnames(p16)<-c("X16.Ci sono persone che mi comprendono davvero","count")
 colnames(p17)<-c("X17.Sono infelice di essere così ritirato ","count")
 colnames(p18)<-c("X18.Le persone sono intorno a me ma non con me","count")
 colnames(p19)<-c("X19.Ci sono persone che posso parlare a","count")
 colnames(p20)<-c("X20.Ci sono persone che lo posso rivolgermi ","count")
 
colonna<-c("Often","Sometimes","Rarely","Never")
  Often<-c(rep(0,20))
  Rarely<-c(rep(0,20))
  Sometimes<-c(rep(0,20))
  Never<-c(rep(0,20))

  nuovaTabella_soli<-data.frame(Often,Rarely,Sometimes,Never)
  nuovaTabella_soli_post<-data.frame(Often,Rarely,Sometimes,Never)

  num_requisito<-function(stringa){
    #RETURN intero
    #elaborazione specifica mi restituisce un numero specifico dalla stringa casuale
     stringa= str_extract(stringa,"X\\d.")
     risultato=str_extract(stringa,"\\d.")
     risultato=as.integer(risultato)
    if(is.integer(risultato)){
      return(risultato)
    }else{
      stringa= str_extract(stringa,"X\\d")
      risultato=str_extract(stringa,"\\d")
      return (as.integer(risultato))
    }
  }
  
  
  #text mining
  numero_requisito<-num_requisito("X1..There.are.people.who.really.understand.me")
  numero_requisito2<-num_requisito("X2..")
  numero_requisito10<-num_requisito("X10..")

 
  sostituzione_pre <- function(table,numero_requisito){
    #RETURN list
    #passaggio da 20 tabelle in un unica tabella sommario
    dimensione<-dim.data.frame(table$count)
    dimensione<-dimensione[2]#trova la dimensione per ogni singola tabella(sono a loro volta diversi)
      for(i in 1:dimensione){ #trovare per ogni riga fino alla fine se 
        if(as.character(table[i,1]) == "Often" && numero_requisito == num_requisito(colnames(table[1]))){ #trova se c'è una corrispondenza nella tabellina e se il numero della domanda sono gli stessi, se si posso mettere nella cella corrispondente
          nuovaTabella_soli[numero_requisito,i]<-table$count[i] #passa valore 
        }else if (as.character(table[i,1])=="Sometimes" &&  numero_requisito==num_requisito(colnames(table[1]))){
           nuovaTabella_soli[numero_requisito,i]<-table$count[i]#
        }else if(as.character(table[i,1])=="Rarely" && numero_requisito == num_requisito(colnames(table[1]))){
           nuovaTabella_soli[numero_requisito,i]<-table$count[i]
        }else if(as.character(table[i,1])=="Never" && numero_requisito == num_requisito(colnames(table[1]))){ 
            nuovaTabella_soli[numero_requisito,i]<-table$count[i]
        }
      }
    return(nuovaTabella_soli)
  }

  nuovaTabella_soli<-sostituzione_pre(s1,numero_requisito)
  nuovaTabella_soli<-sostituzione_pre(s2,numero_requisito2)
  nuovaTabella_soli<-sostituzione_pre(s3,3)
  nuovaTabella_soli<-sostituzione_pre(s4,4)
  nuovaTabella_soli<-sostituzione_pre(s5,5)
  nuovaTabella_soli<-sostituzione_pre(s6,6)
  nuovaTabella_soli<-sostituzione_pre(s7,7)
  nuovaTabella_soli<-sostituzione_pre(s8,8)
  nuovaTabella_soli<-sostituzione_pre(s9,9)
  nuovaTabella_soli<-sostituzione_pre(s10,numero_requisito10)
  nuovaTabella_soli<-sostituzione_pre(s11,11)
  nuovaTabella_soli<-sostituzione_pre(s12,12)
  nuovaTabella_soli<-sostituzione_pre(s13,13)
  nuovaTabella_soli<-sostituzione_pre(s14,14)
  nuovaTabella_soli<-sostituzione_pre(s15,15)
  nuovaTabella_soli<-sostituzione_pre(s16,16)
  nuovaTabella_soli<-sostituzione_pre(s17,17)
  nuovaTabella_soli<-sostituzione_pre(s18,18)
  nuovaTabella_soli<-sostituzione_pre(s19,19)
  nuovaTabella_soli<-sostituzione_pre(s20,20)
view(nuovaTabella_soli[19,4])
   for(j in 1:4){
     for(i in 1:20){
     nuovaTabella_soli[i,j]<-trunc((nuovaTabella_soli[i,j]*100)/46)
    }
  }
  sostituzione_post <- function(table,numero_requisito){
    #RETURN list
    #passaggio da 20 tabelle in un unica tabella sommario
    dimensione<-dim.data.frame(table$count)
    dimensione<-dimensione[2]
      for(i in 1:dimensione){
        if(as.character(table[i,1]) == "Often" && numero_requisito == num_requisito(colnames(table[1]))){ 
          nuovaTabella_soli_post[numero_requisito,i]<-table$count[i]  
        }else if (as.character(table[i,1])=="Sometimes" &&  numero_requisito==num_requisito(colnames(table[1]))){
           nuovaTabella_soli_post[numero_requisito,i]<-table$count[i]#
        }else if(as.character(table[i,1])=="Rarely" && numero_requisito == num_requisito(colnames(table[1]))){
           nuovaTabella_soli_post[numero_requisito,i]<-table$count[i]
        }else if(as.character(table[i,1])=="Never" && numero_requisito == num_requisito(colnames(table[1]))){ 
            nuovaTabella_soli_post[numero_requisito,i]<-table$count[i]
        }else{
          errorCondition("errore")
        }
      }
    return(nuovaTabella_soli_post)
  }
  nuovaTabella_soli_post<-sostituzione_post(p1,numero_requisito)
  nuovaTabella_soli_post<-sostituzione_post(p2,numero_requisito2)
  nuovaTabella_soli_post<-sostituzione_post(p3,3)
  nuovaTabella_soli_post<-sostituzione_post(p4,4)
  nuovaTabella_soli_post<-sostituzione_post(p5,5)
  nuovaTabella_soli_post<-sostituzione_post(p6,6)
  nuovaTabella_soli_post<-sostituzione_post(p7,7)
  nuovaTabella_soli_post<-sostituzione_post(p8,8)
  nuovaTabella_soli_post<-sostituzione_post(p9,9)
  nuovaTabella_soli_post<-sostituzione_post(p10,numero_requisito10)
  nuovaTabella_soli_post<-sostituzione_post(p11,11)
  nuovaTabella_soli_post<-sostituzione_post(p12,12)
  nuovaTabella_soli_post<-sostituzione_post(p13,13)
  nuovaTabella_soli_post<-sostituzione_post(p14,14)
  nuovaTabella_soli_post<-sostituzione_post(p15,15)
  nuovaTabella_soli_post<-sostituzione_post(p16,16)
  nuovaTabella_soli_post<-sostituzione_post(p17,17)
  nuovaTabella_soli_post<-sostituzione_post(p18,18)
  nuovaTabella_soli_post<-sostituzione_post(p19,19)
  nuovaTabella_soli_post<-sostituzione_post(p20,20)
  
    for(j in 1:4){
     for(i in 1:20){
     nuovaTabella_soli_post[i,j]<-trunc((nuovaTabella_soli_post[i,j]*100)/39)
    }
    }
  
  indice<-c(rep(1:20,4))
  frequenza<-c(rep("often",20),rep("sometimes",20),rep("rarely",20),rep("never",20))
  numero<-c(rep(0,80))
  preparazione_grafico=data.frame(indice,frequenza,numero)
  preparazione_grafico_post=data.frame(indice,frequenza,numero)
  
  
  preparazione_grafico[1:20,3] <- nuovaTabella_soli[1:20,1]
  preparazione_grafico[21:40,3] <- nuovaTabella_soli[1:20,2]
  preparazione_grafico[41:60,3] <- nuovaTabella_soli[1:20,3]
  preparazione_grafico[61:80,3] <- nuovaTabella_soli[1:20,4]
  
  preparazione_grafico_post[1:20,3] <- nuovaTabella_soli_post[1:20,1]
  preparazione_grafico_post[21:40,3] <- nuovaTabella_soli_post[1:20,2]
  preparazione_grafico_post[41:60,3] <- nuovaTabella_soli_post[1:20,3]
  preparazione_grafico_post[61:80,3] <- nuovaTabella_soli_post[1:20,4]  
  
  colnames(Scala_Solitudine)<-c("uid","type","X1.Mi sento in sintonia con le persone intorno a me","X2.Ho la mancanza della relazione della compagnia","X3.Non c’è nessuno che lo posso rivolgermi a ","X4.Non mi sento da solo ","X5.Mi sento parte di un gruppo di amici","X6.Ho molto in comune con le persone intorno a me.","X7.Non sono più vicino a nessuno","X8.I miei interessi non sono condivisi da chi intorno a me ","X9.Sono un estroverso a cui mi sento vicino  ","X10.Ci sono persone che sento vicino a","X11.Mi sento lasciato fuori/ Mi sento escluso","X12.Le mie relazioni sociali sono superficiali","X13.Nessuno mi conosce davvero bene","X14.Mi sento isolato dagli altri","X15.Posso trovare compagnia quando lo voglio ","X16.Ci sono persone che mi comprendono davvero","X17.Sono infelice di essere così ritirato ","X18.Le persone sono intorno a me ma non con me","X19.Ci sono persone che posso parlare a","X20.Ci sono persone che lo posso rivolgermi ")

  
  grafico_Solitudine<-preparazione_grafico%>%
    ggplot(aes(x=indice,numero,fill=frequenza))+
    geom_bar(stat="identity",position = position_dodge())+
    scale_fill_manual("Frequenza", values = c( "often" = "#D6AF36", "sometimes" = "#A7A7AD","rarely" = "#A77044","never"= 	"#000000"))+
     theme(axis.title=element_blank())+
    labs(title="Frequenza per solitudine pre")
  
  grafico_Solitudine_post<-preparazione_grafico_post%>%
    ggplot(aes(x=indice,numero,fill=frequenza))+
    geom_bar(stat="identity",position = position_dodge())+
    scale_fill_manual("Frequenza", values = c( "often" = "#D6AF36", "sometimes" = "#A7A7AD","rarely" = "#A77044","never"= "#000000"))+
     theme(axis.title=element_blank())+
    labs(title="Frequenza per solitudine post")
  
  grid.arrange(grafico_Solitudine,grafico_Solitudine_post)
  
```


```{r ,echo= FALSE}
 
ui<-fluidPage(theme = shinytheme("superhero"),
        navbarPage(
         "Valutazione prima e dopo per la didattica a distanza",
         tabPanel("Solitudine confronto",
                   sidebarPanel(
                    h5("Domande"),
                    textOutput("domandeId"),
                    sliderInput("num_pre", "Number:",min = 1, max = 20,step=1,value=c(1,20)),
                    sliderInput("num_post", "Number:",min = 1, max = 20,step=1,value=c(1,20)),
                    ),
                  mainPanel(
                    plotOutput("risultatoPrePlot"),
                    plotOutput("risultatoPostPlot")
                  )
          )
        )
                     #textOutput("domandeId")
)
           
          # tabPanel("tabella riportata",
          #         sidebarPanel(
          #           radioButtons("inputRadioButton","Scelta :",c("Active","Interested","Enthusiastic")),
          #         mainPanel(h1("Risultato"),tableOutput("tabellaDiConfronto"))
          #         )

server <- function(input, output) {
  #manipolazione dei dati
  #------------------------------------------------------------------------- parte server ------------------------------------------------------
  #funzioni per manipolazione della stringa per la domanda di solitudine 
  richiama_domanda<-function(minimo,massimo){
      risul<-c(rep("",20))
      for(i in minimo:massimo){
        risul[i]<-colnames(Scala_Solitudine[i+2])
      }
      return(risul)
  }
  
  scorrimento_pre<-reactive({
     risul1<-preparazione_grafico[(preparazione_grafico$indice %in% seq(from=min(input$num_pre),to=max(input$num_pre),by=1)),]
     risul1
  })
  scorrimento_post<-reactive({
     risul2<-preparazione_grafico_post[(preparazione_grafico_post$indice %in% seq(from=min(input$num_post),to=max(input$num_post),by=1)),]
     risul2
  })
   
  output$risultatoPrePlot <- renderPlot({
      grafico_Solitudine<-preparazione_grafico%>%
      ggplot(data=scorrimento_pre(),mapping= aes(x=indice,y=numero,fill=frequenza))+
      geom_bar(stat="identity",position = position_dodge())+
      scale_fill_manual("Frequenza", values = c( "often" = "#D6AF36", "sometimes" = "#A7A7AD","rarely" = "#A77044","never"="#000000"))+
       theme(axis.title=element_blank())+
      labs(title="Frequenza per solitudine prima di covid")
      
     grafico_Solitudine
   })  
 
 output$risultatoPostPlot <- renderPlot({
   
    grafico_Solitudine_post<-preparazione_grafico_post%>%
    ggplot(data=scorrimento_post(),mapping= aes(x=indice,y=numero,fill=frequenza))+
    geom_bar(stat="identity",position = position_dodge())+
    scale_fill_manual("Frequenza", values = c( "often" = "#D6AF36", "sometimes" = "#A7A7AD","rarely" = "#A77044","never"="#000000"))+
     theme(axis.title=element_blank())+
    labs(title="Frequenza per solitudine dopo di covid")
    
   grafico_Solitudine_post
 })  

 output$domandeId <- renderText({

   domanda<-richiama_domanda(min(input$num_pre),max(input$num_pre))
     domanda
   })


}#server

shinyApp(ui = ui, server = server)
```
 <br><br><br>
 
## Conclusioni

Da questi analisi si genera le seguenti conclusione :<br>
  -1. Con l'andamento della pandemia gli studenti sono suddivisi in 2 grande categorie estreme, da un lato ci sono quelli più bravi che riescono a svolgere il proprio lavoro anche senza una collettività invece altri studenti meno bravi si sono rimasti indietro a causa dagli vari motivi. <br>
  -2.La positività in generale degli studenti per lo studio sono calati il tempo.<br>
  A causa di vari motivi, 
  come lo stress davanti a un dispositivo elettronico per lunghe ore,<br>
  perdere la concentrazione durante la lezione,<br>
  difficile regolarizzare il ritmo di lavoro a causa dell'ambiente,<br>
  la comunicazione efficiente con altri colleghi del corso ecc..
  

  <br><br><br>

## Bibiografia

Come sito di riferimento ho usato Kaggle.com da un dataset pubblico raccolta durante la fase di covid-19